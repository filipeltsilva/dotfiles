#!/usr/bin/env bash

# shellcheck source=./helpers
. helpers
# shellcheck source=./packages
. packages

XDG_CACHE_HOME="$HOME/.cache"
XDG_CONFIG_HOME="$HOME/.config"
XDG_DATA_HOME="$HOME/.local/share"

######## ARCH LINUX ########
header_text "ARCH LINUX SETUP"

warning_text "Installing AUR support by yay"
sudo pacman -Sy

git clone https://aur.archlinux.org/yay-git.git
(
  cd yay-git || exit
  makepkg -si
  rm -rf yay-git
)

warning_text "Installing AUR packages"
yay -S "${AUR_PACKAGES[@]}"

warning_text "Installing Pacman packages"
yay -S "${PACMAN_PACKAGES[@]}" --noconfirm

warning_text "Cleaning temporary files"
yay -Sc --noconfirm

success_text "ARCH LINUX SETUP IS COMPLETE!"

######## FLATPAK ########
header_text "FLATPAK SETUP"

warning_text "Installing Flatpak packages"
flatpak install "${FLATPAK_PACKAGES[@]}"

success_text "FLATPAK SETUP IS COMPLETE!"

######## CREATING LINKS ########
header_text "CREATING DOTFILES LINKS"

warning_text "Symlink files"
create_link "$PWD/asdf" "$XDG_CONFIG_HOME/asdf"
create_link "$PWD/git" "$XDG_CONFIG_HOME/git"
create_link "$PWD/npm" "$XDG_CONFIG_HOME/npm"
create_link "$PWD/nvim" "$XDG_CONFIG_HOME/nvim"
create_link "$PWD/tmux" "$XDG_CONFIG_HOME/tmux"
create_link "$PWD/zsh" "$XDG_CONFIG_HOME/zsh"

create_link "$PWD/.zshenv" "$HOME/.zshenv"

success_text "SYMLINK FILES IS COMPLETE!"

######## INSTALL NEOVIM PACKAGE MANAGER (PACKER) ########
header_text "INSTALLING PACKER"

git_clone wbthomason/packer.nvim "$XDG_DATA_HOME/nvim/site/pack/packer/start/packer.nvim"

success_text "PACKER INSTALLATION IS COMPLETE!"

######## FINAL ADJUSTMENTS ########
header_text "CREATING ZSH HELPERS FOLDERS"

mkdir -p "$XDG_CACHE_HOME/zsh"
mkdir -p "$XDG_DATA_HOME/zsh"

success_text "ZSH HELPERS FOLDERS CREATED!"

header_text "CHANGING DEFAULT SHELL TO ZSH"

sudo chsh -s "$(which zsh)" "$USER"
success_text "DEFAULT SHELL CHANGED!"

